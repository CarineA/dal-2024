{
  "hash": "e7383c0efe0b3d35a9fecdebbf4ba623",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"DAL tutorial - Week 8\"\nsubtitle: \"Advanced plotting\"\neditor: visual\nformat: \n  html:\n    css: [webex.css]\n    include-after-body: [webex.js]\n---\n\n\n## Overview\n\nIn this tutorial, you can go through the different sections in any order you like and you can pick and choose which sections you want to work on.\n\nThe tutors will be able to help you chose sections that might be useful based on your interests or your dissertation projects (whether you are working on it now or you will next year!).\n\nIn this tutorial, there will be less explicit instructions or explanations. Before starting, make sure you attach the necessary packages (like tidyverse).\n\nYou can find information on the data in the [QM data](https://uoelel.github.io/qm-data/) website.\n\n\n\n\n\n## Formant data\n\nIn this section we will plot formant data from Italian.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# .rda are R data files and they can be read with `load()`\nload(\"data/coretta2018a/formants.rda\")\n```\n:::\n\n\nThe data contains F1 and F2 measurements at 3 points within each vowel. We want to plot the values at the mid-point of the vowel.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants |> \n  ggplot(aes(f12, f22, colour = vowel)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/f1-f2-1.png){width=672}\n:::\n:::\n\n\nThis doesn't look right tho... Shouldn't /a/ be at the bottom, /i/ on the top-left and /u/ on the top-right?\n\nLet's fix this! First we need to use `f22` as the *x*-axis and `f12` as the *y*-axis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants |> \n  ggplot(aes(f22, f12, colour = vowel)) +\n  geom_point(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/f2-f1-1.png){width=672}\n:::\n:::\n\n\nBut now the plot is upside-down!\n\nTo fix this we need to reverse both axes with `scale_*_reverse()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants |> \n  ggplot(aes(f22, f12, colour = vowel)) +\n  geom_point(alpha = 0.5) +\n  scale_x_reverse() + scale_y_reverse()\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/f1-f2-reverse-1.png){width=672}\n:::\n:::\n\n\nWe can do better! Let's split the data for each participant and let's plot ellipses for each vowel.\n\nWe can plot speakers separately with `facet_wrap()`: this works like `facet_grid()` but instead of specifying variables for rows and columns you just specify one variable and the data of each value in that variable will be plotted in a separate panel. This is useful when you have many different values, like speaker here. (if you want to learn how to make your plot taller, like the one below, check the Extra box below).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants |> \n  ggplot(aes(f22, f12, colour = vowel)) +\n  geom_point(alpha = 0.5) +\n  stat_ellipse() +\n  scale_x_reverse() + scale_y_reverse() +\n  facet_wrap(vars(speaker), ncol = 3)\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/f1-f2-reverse-wrap-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-important collapse=\"true\"}\n#### Extra: Setting the figure aspect ratio\n\nYou can set the aspect ratio of a figure in a Quarto document with the `fig-asp` Quarto option.\n\n```         \n{r}\n#| label: tall-figure\n#| fig-asp: 1.5\n\n(your figure code)\n```\n:::\n\n## Reaction times\n\nYou have learnt how to use density plots, but an alternative way of plotting continuous data by categorical groups is to use strip charts and violin plots, alone or in combination!\n\nLet's plot reaction times from the `shallow` data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshallow <- read_csv(\"data/song2020/shallow.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 6500 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (8): Group, ID, List, Target, Critical_Filler, Word_Nonword, Relation_ty...\ndbl (3): ACC, RT, logRT\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\nYou can plot violin plots using `geom_violin()`. A violin is basically just a density plot, mirrored vertically. The wider parts of the violin indicate a greater density of data around the related *y*-axis values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshallow |> \n  # we filter to include only the critical trials\n  filter(Critical_Filler == \"Critical\") |> \n  ggplot(aes(Relation_type, RT)) +\n  geom_violin() +\n  facet_grid(cols = vars(Group))\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/violin-1.png){width=672}\n:::\n:::\n\n\nWe can overlay a strip chart, which is basically just the raw data, plotted as dots that are jittered horizontally.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshallow |> \n  # we filter to include only the critical trials\n  filter(Critical_Filler == \"Critical\") |> \n  ggplot(aes(Relation_type, RT)) +\n  geom_violin() +\n  # the width argument in geom_jitter() specifies how wide the jitter should be, as\n  # a value between 0 and 1.\n  # the lower the number, the narrower the jitter.\n  geom_jitter(width = 0.1, alpha = 0.25) +\n  facet_grid(cols = vars(Group))\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/violin-strip-1.png){width=672}\n:::\n:::\n\n\nCan you tell if there are differences in RTs between the different groups and relation types?\n\n## Fundamental frequency (f0)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# .rda are R data files and they can be read with `load()`\nload(\"data/coretta2018a/formants.rda\")\n```\n:::\n\n\nLet's plot f0 for different vowels. We can use a violin plot with a strip chart (see previous section!).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants |> \n  ggplot(aes(label, f0)) +\n  geom_violin() +\n  geom_jitter(width = 0.1, alpha = 0.1)\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/f0-1.png){width=672}\n:::\n:::\n\n\nYou might notice something weird going on... The violins are quite bumpy! This is because different people have different mean f0.\n\nWe want to **normalise** the data across speakers, so that individual differences in mean f0 are removed. This process is also called standardisation or *z*-scoring.\n\n*Z*-scores are a standardised unit that allows you to compare things that are on different scales. Our f0 values are on different scales because some speakers have higher mean f0, some have lower mean f0.\n\n*Z-*scores are calculated by removing the mean from each value and dividing it by the standard deviation. Since we are normalising *within* subject, we need to calculate the mean and standard deviation for each participant and apply those to each participant's data separately.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants <- formants |> \n  # group data by speaker so that normalisation is applied for each speaker\n  # separately\n  group_by(speaker) |> \n  # calculate z-scores\n  mutate(\n    f0_z = (f0 - mean(f0)) / sd(f0)\n  )\n\nhead(formants$f0_z)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]  3.4126740 -0.9289615  1.1254401 -0.5180812 -1.0111376  0.2488954\n```\n\n\n:::\n:::\n\n\nNow we can recreate the plot above but using `f0_z`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformants |> \n  ggplot(aes(label, f0_z)) +\n  geom_violin() +\n  geom_jitter(aes(colour = vowel), width = 0.1, alpha = 0.1)\n```\n\n::: {.cell-output-display}\n![](tutorial-w08_files/figure-html/f0-z-plot-1.png){width=672}\n:::\n:::\n\n\nWhy is `colour = vowel` in `geom_jitter(aes(...))`? Because we want to colour only the jittered points. If we put `colour = vowel` in the main `ggplot(aes(...))` , then the violin *borders* would also be coloured.\n\nIf you want to colour the areas of the violins instead, you can use the `fill` aesthetic. This will work both in the main `ggplot(aes(...))` or in `geom_violin(aes(...))` because the points of `geom_jitter()` can't be given a colour fill, but only a colour.\n",
    "supporting": [
      "tutorial-w08_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}